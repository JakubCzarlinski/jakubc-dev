package head

import "project/src/flags"

templ head(
	headContents map[string]struct{},
) {
	<head>
		<meta charset="UTF-8"/>
		<link rel="stylesheet" href="/assets/index.css"/>
		<script type="module" src="/assets/index.js"></script>
		<link rel="modulepreload" as="script" href="/assets/svelte.js"/>
		@createHeadContents(headContents)
		<title>{ flags.Name }</title>
		<link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMS45IiBoZWlnaHQ9IjMyIiBhcmlhLWhpZGRlbj0idHJ1ZSIgY2xhc3M9Imljb25pZnkgaWNvbmlmeS0tbG9nb3MiIHZpZXdCb3g9IjAgMCAyNTYgMjU3Ij48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImEiIHgxPSItLjglIiB4Mj0iNTcuNiUiIHkxPSI3LjclIiB5Mj0iNzguNCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiM0MUQxRkYiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNCRDM0RkUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjQzLjQlIiB4Mj0iNTAuMyUiIHkxPSIyLjIlIiB5Mj0iODklIj48c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjRkZFQTgzIi8+PHN0b3Agb2Zmc2V0PSI4LjMlIiBzdG9wLWNvbG9yPSIjRkZERDM1Ii8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjRkZBODAwIi8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHBhdGggZmlsbD0idXJsKCNhKSIgZD0iTTI1NSAzOCAxMzUgMjUzYy0zIDQtOSA0LTExIDBMMSAzOGMtMy01IDEtMTEgNy0xMGwxMjAgMjJhNyA3IDAgMCAwIDIgMGwxMTgtMjJjNi0xIDEwIDUgNyAxMFoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMTg1IDAgOTYgMThhMyAzIDAgMCAwLTIgM2wtNiA5MmEzIDMgMCAwIDAgNCAzbDI1LTVjMi0xIDUgMSA0IDNsLTcgMzdjLTEgMiAxIDQgNCAzbDE1LTRjMy0xIDUgMSA0IDNsLTExIDU3Yy0xIDQgNCA2IDYgMmwxLTIgNzItMTQ0YzItMy0xLTUtMy01bC0yNiA1Yy0yIDAtNC0yLTMtNGwxNi01OGMxLTItMS00LTQtNFoiLz48L3N2Zz4K"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description" content="Morning Coffee: A simple task manager."/>
		if flags.UseLiveReload {
			@liveReload()
		}
	</head>
}

templ liveReload() {
	<script type="module">
const eventSource = new EventSource("/sse");

eventSource.onerror = function(event) {
  console.log("Connection Error");
  if (eventSource.readyState === EventSource.CLOSED) {
    console.log("Connection Closed");
  }
  setTimeout(function () {
    location.reload();
  }, 500);
};

eventSource.onopen = function() {
  console.log("Connection Opened: ", new Date().toLocaleString());
};
  </script>
}
